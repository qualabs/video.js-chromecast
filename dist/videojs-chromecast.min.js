/**
 * videojs-chromecast
 * @version 2.0.8
 * @copyright 2019 Benjipott, Inc.
 * @license Apache-2.0
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(t.video||(t.video={})).jsChromecast=e()}}(function(){return function e(t,i,a){function n(r,s){if(!i[r]){if(!t[r]){var c="function"==typeof require&&require;if(!s&&c)return c(r,!0);if(o)return o(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var d=i[r]={exports:{}};t[r][0].call(d.exports,function(e){var i=t[r][1][e];return n(i||e)},d,d.exports,e,t,i,a)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<a.length;r++)n(a[r]);return n}({1:[function(e,t,i){(function(e){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e,t,i){for(var a=!0;a;){var n=e,o=t,r=i;a=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(r)}var u=Object.getPrototypeOf(n);if(null===u)return;e=u,t=o,i=r,a=!0,s=u=void 0}},c="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null,u=function(e){return e&&e.__esModule?e:{default:e}}(c),d=u.default.getComponent("Component"),l=u.default.getComponent("ControlBar"),h=u.default.getComponent("Button"),p=!1,f=function(e){function t(e,i){var n=this;a(this,t),i.appId=e.options_.chromecast.appId,i.metadata=e.options_.chromecast.metadata,s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,i),this.hide(),this.initializeApi(),e.chromecast=this,this.customData={},this.on(e,"dispose",function(){n.casting&&n.apiSession&&n.apiSession.stop(null,null)})}return n(t,e),r(t,[{key:"initializeApi",value:function(){var e=void 0,t=void 0,i=void 0,a=window.chrome;return a&&a.cast&&a.cast.isAvailable?(u.default.log("Cast APIs are available"),t=this.options_.appId||a.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,i=new a.cast.SessionRequest(t),e=new a.cast.ApiConfig(i,this.sessionJoinedListener.bind(this),this.receiverListener.bind(this)),a.cast.initialize(e,this.onInitSuccess.bind(this),this.castError.bind(this))):(u.default.log("Cast APIs not available"),this.tryingReconnect<10&&(this.setTimeout(this.initializeApi,1e3),++this.tryingReconnect),void u.default.log("Cast APIs not available. Max reconnect attempt"))}},{key:"castError",value:function(e){var t={code:e.code,message:e.description};switch(e.code){case chrome.cast.ErrorCode.API_NOT_INITIALIZED:case chrome.cast.ErrorCode.EXTENSION_MISSING:case chrome.cast.ErrorCode.EXTENSION_NOT_COMPATIBLE:case chrome.cast.ErrorCode.INVALID_PARAMETER:case chrome.cast.ErrorCode.LOAD_MEDIA_FAILED:case chrome.cast.ErrorCode.RECEIVER_UNAVAILABLE:case chrome.cast.ErrorCode.SESSION_ERROR:case chrome.cast.ErrorCode.CHANNEL_ERROR:case chrome.cast.ErrorCode.TIMEOUT:this.addClass("error");break;case chrome.cast.ErrorCode.CANCEL:break;default:this.player_.error(t)}return u.default.log("Cast Error: "+JSON.stringify(e))}},{key:"onInitSuccess",value:function(){return p?this.show():this.hide(),this.apiInitialized=!0}},{key:"sessionJoinedListener",value:function(e){return e.media.length&&(this.apiSession=e,this.onMediaDiscovered(e.media[0])),console.log("Session joined")}},{key:"receiverListener",value:function(e){return"available"===e?(p=!0,this.show()):(p=!1,this.hide())}},{key:"doLaunch",value:function(e){return this.customData=e,u.default.log("Cast video: "+this.player_.cache_.src),this.apiInitialized?this.casting?this.onSessionSuccess(this.apiSession):chrome.cast.requestSession(this.onSessionSuccess.bind(this),this.castError.bind(this)):u.default.log("Session not initialized")}},{key:"onSessionSuccess",value:function(e){var t=void 0,i=void 0,a=void 0,n=void 0,r=void 0,s=void 0;this.apiSession=e;var c=this.player_.cache_.source,d=this.player_.currentType();if(u.default.log("Session initialized: "+e.sessionId+" source : "+c+" type : "+d),n=new chrome.cast.media.MediaInfo(c.src,c.type),this.customData&&(n.customData=o({},n.customData,this.customData)),n.metadata=new chrome.cast.media.GenericMediaMetadata,this.options_.metadata){r=this.options_.metadata;for(i in r)s=r[i],n.metadata[i]=s}var l=this.player().poster();l&&(t=new chrome.cast.Image(l),n.metadata.images=[t]),n.textTrackStyle=new chrome.cast.media.TextTrackStyle,n.textTrackStyle.foregroundColor="#FFFFFF",n.textTrackStyle.backgroundColor="#00000060",n.textTrackStyle.edgeType=chrome.cast.media.TextTrackEdgeType.DROP_SHADOW,n.textTrackStyle.windowType=chrome.cast.media.TextTrackWindowType.ROUNDED_CORNERS,a=new chrome.cast.media.LoadRequest(n),a.autoplay=!0,a.currentTime=this.player_.currentTime(),this.oldTech=(" "+this.player_.techName_).slice(1),this.oldSrc=this.player_.currentSource(),this.apiSession.loadMedia(a,this.onMediaDiscovered.bind(this),this.castError.bind(this)),this.apiSession.addUpdateListener(this.onSessionUpdate.bind(this))}},{key:"onMediaDiscovered",value:function(e){this.player_.loadTech_("Chromecast",{type:"cast",apiMedia:e,apiSession:this.apiSession}),this.casting=!0,this.inactivityTimeout=this.player_.options_.inactivityTimeout,this.player_.options_.inactivityTimeout=0,this.player_.userActive(!0),this.player_.trigger("castConnected"),this.addClass("connected"),this.removeClass("error")}},{key:"onSessionUpdate",value:function(e){if(this.player_.apiMedia)return e?void 0:this.onStopAppSuccess()}},{key:"stopCasting",value:function(){return this.apiSession.stop(this.onStopAppSuccess.bind(this),this.castError.bind(this))}},{key:"onStopAppSuccess",value:function(){var e=this.player_.paused(),t=this.player_.currentTime();return this.casting=!1,this.player_.loadTech_(this.oldTech),this.removeClass("connected"),e||this.player_.one("seeked",function(){return this.player_.play()}),this.player_.currentTime(t),this.player_.options_.inactivityTimeout=this.inactivityTimeout,this.player_.trigger("seeked"),this.player_.trigger("castDisconnected"),this.apiSession=null}},{key:"buildCSSClass",value:function(){return"vjs-chromecast-button "+s(Object.getPrototypeOf(t.prototype),"buildCSSClass",this).call(this)}},{key:"handleClick",value:function(e){return s(Object.getPrototypeOf(t.prototype),"handleClick",this).call(this,e),this.casting?this.stopCasting():this.doLaunch(e)}}]),t}(h);f.prototype.tryingReconnect=0,f.prototype.inactivityTimeout=2e3,f.prototype.controlText_="Chromecast",l.prototype.options_.children.splice(l.prototype.options_.children.length-1,0,"chromeCastButton"),d.registerComponent("ChromeCastButton",f),i.default=f,t.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,i){(function(e){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),r=function(e,t,i){for(var a=!0;a;){var n=e,o=t,r=i;a=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(r)}var u=Object.getPrototypeOf(n);if(null===u)return;e=u,t=o,i=r,a=!0,s=u=void 0}},s="undefined"!=typeof window?window.videojs:void 0!==e?e.videojs:null,c=function(e){return e&&e.__esModule?e:{default:e}}(s),u=(c.default.getComponent("Component"),c.default.getComponent("Tech")),d=function(e){function t(e,i){var n=this;a(this,t),r(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,i),this.apiMedia=this.options_.source.apiMedia,this.apiSession=this.options_.source.apiSession,this.receiver=this.apiSession.receiver.friendlyName,this.activeTracks=null,this.changeHandler=this.handleTracksChange.bind(this);var o=this.onMediaStatusUpdate.bind(this),s=this.onSessionUpdate.bind(this);this.apiMedia.addUpdateListener(o),this.apiSession.addUpdateListener(s),this.on("dispose",function(){n.apiMedia.removeUpdateListener(o),n.apiSession.removeUpdateListener(s),n.onMediaStatusUpdate(),n.onSessionUpdate(!1)}),this.loadTracks(),this.update(),this.triggerReady()}return n(t,e),o(t,[{key:"loadTracks",value:function(){var e=this,t=this.apiMedia.media.tracks,i=this.apiMedia.activeTrackIds;t.forEach(function(t){var a=i.indexOf(t.trackId)>-1;t.type===chrome.cast.media.TrackType.AUDIO&&e.createAudioTrack_(t,a),t.type===chrome.cast.media.TrackType.TEXT&&e.createTextTrack_(t,a)});var a=this.textTracks();a&&(a.addEventListener("change",this.changeHandler),this.on("dispose",function(){a.removeEventListener("change",this.changeHandler)})),(a=this.audioTracks())&&(a.addEventListener("change",this.changeHandler),this.on("dispose",function(){a.removeEventListener("change",this.changeHandler)}))}},{key:"createAudioTrack_",value:function(e,t){var i=new c.default.AudioTrack({id:e.trackId,kind:"translation",label:e.language,language:e.language,enabled:t});this.audioTracks().addTrack(i)}},{key:"createTextTrack_",value:function(e,t){var i=t?"showing":"disabled",a=new c.default.TextTrack({id:e.trackId,tech:this,kind:"subtitles",mode:i,label:e.language,language:e.language,srclang:e.language,default:!1});this.textTracks().addTrack(a)}},{key:"createEl",value:function(){return c.default.dom.createEl("div",{id:this.options_.techId,className:"vjs-tech vjs-tech-chromecast"})}},{key:"update",value:function(){this.el_.innerHTML='<div class="casting-image" style="background-image: url(\''+this.options_.poster+'\')"></div><div class="casting-overlay"><div class="casting-information"><div class="casting-icon"></div><div class="casting-description"><small>'+this.localize("CASTING TO")+"</small><br>"+this.receiver+"</div></div></div>"}},{key:"onSessionUpdate",value:function(e){if(this.apiMedia)return e?void 0:this.onStopAppSuccess()}},{key:"onStopAppSuccess",value:function(){this.stopTrackingCurrentTime(),this.apiMedia=null}},{key:"onMediaStatusUpdate",value:function(){if(this.apiMedia)switch(this.activeTracks&&JSON.stringify(this.activeTracks.sort())===JSON.stringify(this.apiMedia.activeTrackIds.sort())||(this.onActiveTrackChange(this.apiMedia.activeTrackIds),this.activeTracks=this.apiMedia.activeTrackIds),this.apiMedia.playerState){case chrome.cast.media.PlayerState.BUFFERING:this.trigger("waiting");break;case chrome.cast.media.PlayerState.IDLE:this.trigger("timeupdate"),this.trigger("ended");break;case chrome.cast.media.PlayerState.PAUSED:this.trigger("pause"),this.paused_=!0;break;case chrome.cast.media.PlayerState.PLAYING:this.trigger("playing"),this.trigger("play"),this.paused_=!1}}},{key:"src",value:function(e){}},{key:"currentSrc",value:function(){if(this.apiMedia)return this.apiMedia.media.contentId}},{key:"handleTracksChange",value:function(){var e=[],t=this.audioTracks().tracks_,i=this.textTracks().tracks_;if(t.forEach(function(t){t.enabled&&e.push(t.id)}),i.forEach(function(t){"showing"===t.mode&&e.push(t.id)}),this.apiMedia&&e.length)return this.tracksInfoRequest=new chrome.cast.media.EditTracksInfoRequest(e),this.apiMedia.editTracksInfo(this.tracksInfoRequest,this.onTrackSuccess.bind(this),this.onTrackError.bind(this))}},{key:"onActiveTrackChange",value:function(e){var t=this.audioTracks(),i=this.textTracks();t.removeEventListener("change",this.changeHandler),i.removeEventListener("change",this.changeHandler),t.tracks_.forEach(function(t){e.indexOf(t.id)>-1?t.enabled=!0:t.enabled=!1}),i.tracks_.forEach(function(t){e.indexOf(t.id)>-1?t.mode="showing":t.mode="disabled"}),t.addEventListener("change",this.changeHandler),i.addEventListener("change",this.changeHandler)}},{key:"onTrackSuccess",value:function(){return c.default.log("track added")}},{key:"onTrackError",value:function(e){return c.default.log("Cast track Error: "+JSON.stringify(e))}},{key:"castError",value:function(e){return c.default.log("Cast Error: "+JSON.stringify(e))}},{key:"play",value:function(){if(this.apiMedia)return this.paused_&&this.apiMedia.play(null,this.mediaCommandSuccessCallback.bind(this,"Playing: "+this.apiMedia.sessionId),this.castError.bind(this)),this.paused_=!1}},{key:"pause",value:function(){if(this.apiMedia)return this.paused_?void 0:(this.apiMedia.pause(null,this.mediaCommandSuccessCallback.bind(this,"Paused: "+this.apiMedia.sessionId),this.castError.bind(this)),this.paused_=!0)}},{key:"paused",value:function(){return this.paused_}},{key:"ended",value:function(){return"FINISHED"===chrome.cast.media.IdleReason}},{key:"currentTime",value:function(){return this.apiMedia?this.apiMedia.getEstimatedTime():0}},{key:"setCurrentTime",value:function(e){if(!this.apiMedia)return 0;var t=void 0;return t=new chrome.cast.media.SeekRequest,t.currentTime=e,this.apiMedia.seek(t,this.onSeekSuccess.bind(this,e),this.castError.bind(this))}},{key:"onSeekSuccess",value:function(e){c.default.log("seek success"+e)}},{key:"volume",value:function(){return this.volume_}},{key:"duration",value:function(){return this.apiMedia?this.apiMedia.media.duration||1/0:0}},{key:"controls",value:function(){return!1}},{key:"setVolume",value:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],i=void 0,a=void 0;if(this.apiMedia)return a=new chrome.cast.Volume,a.level=e,a.muted=t,this.volume_=a.level,this.muted_=t,i=new chrome.cast.media.VolumeRequest,i.volume=a,this.apiMedia.setVolume(i,this.mediaCommandSuccessCallback.bind(this,"Volume changed"),this.castError.bind(this)),this.trigger("volumechange")}},{key:"mediaCommandSuccessCallback",value:function(e){c.default.log(e)}},{key:"muted",value:function(){return this.muted_}},{key:"setMuted",value:function(e){return this.setVolume(this.volume_,e)}},{key:"supportsFullScreen",value:function(){return!1}},{key:"resetSrc_",value:function(e){e()}},{key:"dispose",value:function(){this.resetSrc_(Function.prototype),r(Object.getPrototypeOf(t.prototype),"dispose",this).call(this,this)}}]),t}(u);d.prototype.paused_=!1,d.prototype.options_={},d.prototype.timerStep=1e3,d.isSupported=function(){return!0},u.withSourceHandlers(d),d.nativeSourceHandler={},d.nativeSourceHandler.canPlayType=function(e){var t=/^application\/(?:dash\+xml|(x-|vnd\.apple\.)mpegurl)/i,i=/^video\/(mpd|mp4|webm|m3u8)/i;return t.test(e)?"probably":i.test(e)?"maybe":""},d.nativeSourceHandler.canHandleSource=function(e){return e.type?d.nativeSourceHandler.canPlayType(e.type):e.src?d.nativeSourceHandler.canPlayType(e.src):""},d.nativeSourceHandler.handleSource=function(e,t){t.src(e.src)},d.nativeSourceHandler.dispose=function(){},d.registerSourceHandler(d.nativeSourceHandler),d.prototype.featuresVolumeControl=!0,d.prototype.featuresPlaybackRate=!1,d.prototype.movingMediaElementInDOM=!1,d.prototype.featuresFullscreenResize=!1,d.prototype.featuresTimeupdateEvents=!1,d.prototype.featuresProgressEvents=!1,d.prototype.featuresNativeTextTracks=!1,d.prototype.featuresNativeAudioTracks=!1,d.prototype.featuresNativeVideoTracks=!1,c.default.options.chromecast={},u.registerTech("Chromecast",d),i.default=d,t.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,i){(function(a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(e,t,i){for(var a=!0;a;){var n=e,o=t,r=i;a=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;if(void 0===c)return;return c.call(r)}var u=Object.getPrototypeOf(n);if(null===u)return;e=u,t=o,i=r,a=!0,s=u=void 0}},c="undefined"!=typeof window?window.videojs:void 0!==a?a.videojs:null,u=n(c),d=e("./component/control-bar/chromecast-button"),l=(n(d),e("./tech/chromecast")),h=(n(l),u.default.getComponent("Component")),p=function(e){function t(e,i){o(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,i)}return r(t,e),t}(h);p.prototype.options_={},u.default.options.children.push("chromecast"),u.default.addLanguage("en",{"CASTING TO":"WIEDERGABE AUF"}),u.default.addLanguage("de",{"CASTING TO":"WIEDERGABE AUF"}),u.default.addLanguage("it",{"CASTING TO":"PLAYBACK SU"}),u.default.addLanguage("fr",{"CASTING TO":"CAST EN COURS SUR"}),h.registerComponent("Chromecast",p),i.default=p,t.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./component/control-bar/chromecast-button":1,"./tech/chromecast":2}],4:[function(e,t,i){(function(a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(i,"__esModule",{value:!0});var o="undefined"!=typeof window?window.videojs:void 0!==a?a.videojs:null,r=n(o),s=e("./videojs-chromecast"),c=(n(s),function(e){this.addChild("Chromecast",e)});(r.default.registerPlugin||r.default.plugin)("chromecast",c),i.default=c,t.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./videojs-chromecast":3}]},{},[4])(4)});